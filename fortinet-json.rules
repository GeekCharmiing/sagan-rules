# Sagan fortinet-json.rules
# Copyright (c) 2009-2023. Quadrant Information Security <www.quadrantsec.com>
# All rights reserved.
#
# Please submit any custom rules or ideas to sagan-submit@quadrantsec.com or the sagan-sigs mailing list
#
#*************************************************************
#  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the
#  following conditions are met:
#
#  * Redistributions of source code must retain the above copyright notice, this list of conditions and the following
#    disclaimer.
#  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the
#    following disclaimer in the documentation and/or other materials provided with the distribution.
#  * Neither the name of the nor the names of its contributors may be used to endorse or promote products derived
#    from this software without specific prior written permission.
#
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES,
#  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
#  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
#  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
#  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
#  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
#  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
#*************************************************************
# These are mostly taken from Fortigate 4.0 Message reference manual. 

# These are primarily for Legacy Fortigate logs. New logs are covered by Fortinet-648.rules

# Log Reference: https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/b43f86b1-9e63-11ed-8e6d-fa163e15d75b/FortiOS_7.2.4_Log_Reference.pdf

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Protect profile changed"; content: "32151|22 2c 22|type"; content: "changed protection profile"; classtype: configuration-change; sid:5014368; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] ICMP traffic disallowed"; content: "16003|22 2c 22|type"; parse_src_ip: 1; classtype: not-suspicious; sid:5014369; rev:3;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Login from LCD"; content: "32001|22 2c 22|type"; content: "from LCD"; classtype: successful-admin; sid:5014370; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Super Administrator Login"; content: "32001|22 2c 22|type"; content: "logged in"; content:"profile|22 3a 22|super_admin|22|"; parse_src_ip: 1; classtype: successful-admin; sid:5014371; rev:4;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin login from LCD failed"; content: "32002|22 2c 22|type"; content: "LCD failed"; classtype: attempted-admin; sid:5014372; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin login failed"; content: "32002|22 2c 22|type"; content: "login failed"; parse_src_ip: 1; classtype: attempted-admin; sid:5014373; rev:3;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] To many bad admin login attempts"; content: "32002|22 2c 22|type"; content: "bad attempts"; parse_src_ip: 1; classtype: attempted-admin; sid:5014374; rev:3;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Administrator logout"; content: "32003|22 2c 22|type"; content: "action|22 3a 22|ogout"; classtype: not-suspicious; sid:5014375; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] IPS error mode"; content: "32004|22 2c 22|type"; content: "error mode"; classtype: hardware-event; sid:5014376; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin Login failed [Password Spray] [25/10]"; content: "32002|22 2c 22|type"; content: "login failed"; parse_src_ip: 1; classtype: brute-force; xbits: set,brute_force, track ip_src, expire 21600; after: track by_src, count 25, seconds 300; threshold: type suppress, track by_src, count 10, seconds 300; sid:5014377; rev:12;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Login accepted"; content: "32006|22 2c 22|type"; content: "login"; meta_content: "%sagan%",accepted,successfully; parse_src_ip: 1; classtype: successful-admin; sid:5014378; rev:4;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Disk full or almost full"; content: "32006|22 2c 22|type"; content: "disk"; nocase; content: "log "; nocase; meta_content: "%sagan%",exceeds,full; classtype: hardware-event; sid:5014379; rev:3;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Fortigate has started"; content: "32006|22 2c 22|type"; content: "Fortigate started"; classtype: hardware-event; sid:5014380; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Fortigate has entered error mode"; content: "32006|22 2c 22|type"; content: "entered error mode"; classtype: configuration-error; sid:5014381; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Fortigate has left error mode"; content: "32006|22 2c 22|type"; content: "out of error mode"; classtype: configuration-error; sid:5014382; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Administrator session timeout"; content: "32007|22 2c 22|type"; content: "session timed out"; parse_src_ip: 1; classtype: not-suspicious; sid:5014383; rev:3;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Abnormal Admin session drop"; content: "32007|22 2c 22|type"; content: "terminates the sessions"; parse_src_ip: 1; classtype: not-suspicious; sid:5014384; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Normal administrator logout"; content: "32007|22 2c 22|type"; pcre: "/logs out from|is diconnected by/"; parse_src_ip: 1;  classtype: not-suspicious; sid:5014385; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Administrator is clearing/deleting logs"; content: "32007|22 2c 22|type"; pcre: "/has removed|has deleted|has cleared/"; classtype: configuration-change; sid:5014386; rev:3;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Cannot store config.  Low flash space"; content: "32007|22 2c 22|type"; content: "Cannot store config"; content: "flash space"; classtype: hardware-event; sid:5014387; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin has left current VDOM"; content: "32007|22 2c 22|type"; content: "has left the virtual domain"; classtype: not-suspicious; sid:5014388; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin login failure"; content: "32009|22 2c 22|type"; content: "login failed from"; classtype: attempted-admin; sid:5014389; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Disk logs usage have exceeded"; content: "32010|22 2c 22|type"; pcre: "/Disk logs|error mode|Log disk|reason|22 3a 22|isk-log-full/"; classtype: hardware-event; sid:5014390; rev:3;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Memory usage has exceeded"; content: "32010|22 2c 22|type"; content: "reason|22 3a 22|emory-log-full"; classtype: hardware-event; sid:5014391; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Reason unknown error"; content: "32010|22 2c 22|type"; content: "reason|22 3a 22|nknown"; classtype: hardware-event; sid:5014392; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Out of error mode"; content: "32012|22 2c 22|type"; content: "out of error mode"; classtype: hardware-event; sid:5014393; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Administrator removed logs"; content: "32013|22 2c 22|type"; meta_content: "%sagan%",cleared,deleted,removed; classtype: configuration-change; sid:5014394; rev:4;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] License about to expired"; content: "32014|22 2c 22|type"; content: "license will expire"; classtype: program-error; sid:5014395; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Log disk is full"; content: "32015|22 2c 22|type"; content: "Log disk is"; content: "full"; classtype: hardware-event; sid:5014396; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Corrupted MAC packet detected"; content: "32020|22 2c 22|type"; content: "Corrupted MAC packet detected"; classtype: network-event; sid:5014397; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Action reboot or shutdown"; content: "32095|22 2c 22|type"; meta_content: "%sagan%",action|22 3a 22|eboot,action|22 3a 22|hutdown"; classtype: hardware-event; sid:5014398; rev:4;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Action reload"; content: "32095|22 2c 22|type"; content: "action|22 3a 22|eload"; classtype: system-event; sid:5014399; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Action factory_reset"; content: "32095|22 2c 22|type"; content: "action|22 3a 22|actory_reset"; classtype: configuration-change; sid:5014400; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] New access profile added"; content: "32101|22 2c 22|type"; content: "added new access profile"; classtype: configuration-change; sid:5014401; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Configuration change"; content: "32102|22 2c 22|type"; content: "made a change"; classtype: configuration-change; sid:5014402; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Access profile changed"; content: "32102|22 2c 22|type"; content: "setting of access profile"; classtype: configuration-change; sid:5014403; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Access profile deleted"; content: "32103|22 2c 22|type"; content: "deleted an access profile"; classtype: configuration-change; sid:5014404; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] New admin user added"; content: "32120|22 2c 22|type"; content: "added an admin user"; classtype: configuration-change; sid:5014405; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] New user group added"; content: "32120|22 2c 22|type"; content: "added an user group"; classtype: configuration-change; sid:5014406; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin changed another admin's password"; content: "32150|22 2c 22|type"; content: "changed password of admin"; classtype: configuration-change; sid:5014407; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Flash memory is full!"; content: "20031|22 2c 22|type"; content: "flash memory is full"; classtype: hardware-event; sid:5014408; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin authentication success"; content: "38001|22 2c 22|type"; content: "succeeded in authentication"; classtype: successful-admin; sid:5014409; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin authentication failure"; content: "38001|22 2c 22|type"; content: "failed in authentication"; classtype: attempted-admin; sid:5014410; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin authentication failure"; content: "38002|22 2c 22|type"; pcre: "/failed to authenticate|failed in authentication/i"; parse_src_ip: 1; classtype: attempted-admin; sid:5014411; rev:3;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Failed authentication to many times"; content: "38003|22 2c 22|type"; content: "failed authentication to many times"; classtype: attempted-admin; sid:5014412; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Chassis fan anomaly"; content: "99503|22 2c 22|type"; content: "Chassis fan anomaly"; classtype: hardware-event; sid:5014413; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Chassis temperature anomaly"; content: "99504|22 2c 22|type"; content: "Chassis temperature anomaly"; classtype: hardware-event; sid:5014414; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Chassis voltage anomaly"; content: "99505|22 2c 22|type"; content: "Chassis voltage anomaly"; classtype: hardware-event; sid:5014415; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Blade fan anomaly"; content: "99506|22 2c 22|type"; content: "Blade fan anomaly"; classtype: hardware-event; sid:5014416; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Blade temperature anomaly"; content: "99507|22 2c 22|type"; content: "Blade temperature anomaly"; classtype: hardware-event; sid:5014417; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Blade voltage anomaly"; content: "99508|22 2c 22|type"; content: "Blade voltage anomaly"; classtype: hardware-event; sid:5014418; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] L2TP/PPTP/PPPoE Authentication success"; content: "29002|22 2c 22|type"; content: "action|22 3a 22|uth_success"; classtype: successful-user; sid:5014419; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] L2TP/PPTP/PPPoE Authentication failed"; content: "29003|22 2c 22|type"; content: "action|22 3a 22|uth_failed"; classtype: unsuccessful-user; sid:5014420; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] L2TP/PPTP/PPPoE Max connection reached"; content: "29004|22 2c 22|type"; content: "No more clients can connect"; classtype: system-event; sid:5014421; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] L2TP/PPTP/PPPoE Not enough memory"; content: "29024|22 2c 22|type"; content: "not enough memory"; classtype: hardware-event; sid:5014422; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Data Leak Prevention Rule Matched"; content: "11000|22 2c 22|type"; content: "Data Leak Prevention Rule matched"; classtype: policy-violation; sid:5014423; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Application control instant messaging message"; content: "11600|22 2c 22|type"; content: "kind|22 3a 22|"; classtype: policy-violation; sid:5014424; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Application control instant message file tranfer message"; content: "116001|22 2c 22|type"; content: "kind|22 3a 22|"; classtype: policy-violation; sid:5014425; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Application control instant message chat message"; content: "116002|22 2c 22|type"; content: "kind|22 3a 22|"; classtype: policy-violation; sid:5014426; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Control instant message SIP session blocked message"; content: "116003|22 2c 22|type"; content: "kind|22 3a 22|"; classtype: policy-violation; sid:5014427; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Application control instant message message"; content: "116010|22 2c 22|type"; content: "kind|22 3a 22|"; classtype: policy-violation; sid:5014428; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] An application control VoIP-SIP session blocked message"; content: "116011|22 2c 22|type"; content: "kind|22 3a 22|"; classtype: policy-violation; sid:5014429; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] E-mail of an infected file"; content: "60000|22 2c 22|type"; classtype: suspicious-traffic; sid:5014430; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] File blocked via e-mail"; content: "63000|22 2c 22|type"; classtype: suspicious-traffic; sid:5014431; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] File intercepted via e-mail"; content: "63002|22 2c 22|type"; classtype: suspicious-traffic; sid:5014432; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack signature matched [see content] [1]"; content: "70000|22 2c 22|type"; classtype: misc-attack; sid:5014433; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack signature matched [see content] [2]"; content: "73001|22 2c 22|type"; classtype: misc-attack; sid:5014434; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Banned word was found"; content: "90000|22 2c 22|type"; classtype: policy-violation; sid:5014435; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Cookie was removed"; content: "91000|22 2c 22|type"; classtype: web-application-activity; sid:5014436; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Java applet was removed"; content: "91005|22 2c 22|type"; classtype: web-application-activity; sid:5014437; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] ActiveX script was removed"; content: "91010|22 2c 22|type"; classtype: web-application-activity; sid:5014438; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] URL was in blacklist"; content: "93002|22 2c 22|type"; classtype: policy-violation; sid:5014439; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] URL belongs to a denied category"; content: "99501|22 2c 22|type"; classtype: policy-violation; sid:5014440; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] calloc failed"; content: "93007|22 2c 22|type"; content: "calloc"; content: "failed"; classtype: hardware-event; sid:5014441; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] FTP attempt"; content: "80000|22 2c 22|type"; content: "user|22 3a 22|"; content: "group|22 3a 22|"; classtype: suspicious-traffic; sid:5014442; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Entered system conserve mode!"; content: "22802|22 2c 22|type"; content: "entered system conserve mode"; classtype: hardware-event; sid:5014443; rev:2;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Leaving system conserve mode"; content: "22803|22 2c 22|type"; content: "exited system conserve mode"; classtype: hardware-event; sid:5014444; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] General CRITICAL event"; content: "devname|22 3a 22|"; content: "pri|22 3a 22|ritical"; content:!"Alarm Cleared"; content:!"logged out from"; content:!"physical-port-change"; classtype: hardware-event; sid:5014445; rev:4;)

# 01/04/2013
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Botnet traffic detected"; content: "app_list|22 3a 22|BotnetOnly|22| app_type|22 3a 22|Botnet|22|"; classtype: trojan-activity; parse_src_ip: 1; parse_dst_ip: 2; sid:5014446; rev:3;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] SSH traffic detected"; content: " service|22 3a 22|SH "; classtype: trojan-activity; parse_src_ip: 1; parse_dst_ip: 2; sid:5014447; rev:2;)

#*************************************************************
#The below are new Fortinet rules
# These are mostly taken from Fortigate 6.4.8 Message reference manual.
#Written by Charles Goggins - Quadrant Information Security

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] IPS Session Scan Paused"; json_content: ".logid", "0100022700"; classtype: system-error; sid:5014449; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Compromised Host Detected By IOC"; json_content: ".logid", "0100022953"; classtype: malware; sid:5014450; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] IPv6 firewall inbound policy added"; json_content: ".logid", "0100032151"; classtype: configuration-change; sid:5014451; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin Login Failed [5/5]"; json_content: ".logid", "0100032002"; json_map: "username", ".user"; after: track by_src&by_username, count 5, seconds 300; threshold: type suppress, track by_src&by_username, count 1, seconds 86400; classtype: attempted-admin; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014452; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Support License expiring"; json_content: ".logid", "0100032014"; classtype: program-error; sid:5014453; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Data Leak Prevention Rule Matched"; json_content: ".logid", "0954024576"; classtype: policy-violation; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014454; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Application control instant message - file tranfer"; json_content: ".logid", "1059028675"; classtype: policy-violation; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014455; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Infected File Detected Within Email"; json_content: ".logid", "0211008194"; classtype: suspicious-traffic; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014456; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack Detected by UDP/TCP Signature"; json_content: ".logid", "0419016384"; json_content: !".action", "dropped"; json_meta_content:!".severity", info,low,medium; classtype: misc-attack; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014457; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack detected by ICMP Signature"; json_content: ".logid", "0419016385"; json_meta_content:!".severity", info,low,medium; classtype: misc-attack; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014458; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack detected by Other Signature"; json_content: ".logid", "0419016386"; json_meta_content:!".severity", info,low,medium; classtype: misc-attack; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014459; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack detected by Malicious URL"; json_content: ".logid", "0421016399"; content:!"URL blocked "; classtype: misc-attack; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014460; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Botnet C&C Communication - Warning"; json_content: ".logid", "0402016400"; classtype: misc-attack; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014461; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] URL Belongs to Allowed Category Within Firewall Policy"; json_content: ".logid", "0317013312"; classtype: not-suspicious; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014462; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET]  Successful VPN Login From Outside HOME_COUNTRY"; json_content: ".logid", "0101039424"; classtype: suspicious-traffic; json_map: "src_ip", ".srcip"; country_code: track by_src, isnot $HOME_COUNTRY; sid:5014463; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Infected File Detected and Blocked"; json_content: ".logid", "0211008192"; classtype: system-event; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014464; rev:2; metadata: updated_on 2024_06_20;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Infected File Detected and Passed"; json_content: ".logid", "0211008193"; classtype: malware; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014465; rev:2; metadata: updated_on 2025_01_21;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Virus Command Blocked"; json_content: ".logid", "0206008452"; classtype: system-event; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014466; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] App-Control IPS Pass"; json_content: ".logid", "1059028704"; classtype: system-event; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014467; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] App-Control IPS Block"; json_content: ".logid", "1059028705"; classtype: system-event; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014468; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] SSL Certificate Anomaly - Blocked"; json_content: ".logid", "1700062303"; classtype: suspicious-traffic; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014469; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] SSL Certificate Anomaly - Blacklisted"; json_content: ".logid", "1700062300"; classtype: suspicious-traffic; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014470; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] SSL Certificate Anomaly - SNI Mismatched"; json_content: ".logid", "1700062304"; classtype: suspicious-traffic; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014471; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] DNS - Domain Belongs to a Denied Category in Policy"; json_content: ".logid", "1501054803"; classtype: suspicious-traffic; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014472; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Web Filter Rating Error Occurred"; json_content: ".logid", "0318012800"; classtype: system-error; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014473; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack Detected by UDP/TCP Anomaly"; json_content: ".logid", "0720018432"; json_meta_content:!".severity", info,low,medium; classtype: misc-attack; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014474; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack Detected by ICMP Anomaly"; json_content: ".logid", "0720018433"; json_meta_content:!".severity", info,low,medium; classtype: misc-attack; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014475; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack Detected by Other Anomaly"; json_content: ".logid", "0720018434"; json_meta_content:!".severity", info,low,medium; classtype: misc-attack; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014476; rev:1;)
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin Login Disabled"; json_content: ".logid", "0100032021"; classtype: system-event; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; sid:5014477; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Login Failed via VPN - Brute Force [10/5]"; json_content: ".logid", "0101039426"; json_map: "src_ip", ".remip"; after: track by_src, count 10, seconds 300; xbits: set, brute_force,track ip_src, expire 21600; threshold: type suppress, track by_src, count 1, seconds 21600; classtype: brute-force; sid:5014478; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] VPN Login After Brute Force "; json_content: ".logid", "0101039424"; json_map: "src_ip", ".srcip"; xbits: isset, brute_force,track ip_src; threshold: type suppress, track by_src, count 5, seconds 3600; classtype: correlated-attack; sid:5014479; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Possible CVE-2022-40684 Indicators Detected"; json_content: ".type", "event"; json_content: ".user", "Local_Process_Access"; json_meta_content: ".ui", Node.js, Report Runner; reference:url,www.horizon3.ai/fortinet-iocs-cve-2022-40684/; classtype:attempted-admin; sid:5014480; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Filesystem Write Violation"; json_content: ".logid","0100020230"; reference:url,docs.fortinet.com/document/fortigate/7.4.0/new-features/226732/real-time-file-system-integrity-checking; classtype:malware; sid:5014481; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Attempt to replace symlink"; json_content: ".logid","0100020231"; reference:url,docs.fortinet.com/document/fortigate/7.4.0/new-features/226732/real-time-file-system-integrity-checking; classtype:malware; sid:5014482; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Non-Kernel module loaded"; json_content: ".logid","0100020232"; reference:url,docs.fortinet.com/document/fortigate/7.4.0/new-features/226732/real-time-file-system-integrity-checking; classtype:malware; sid:5014483; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] File Hash does not match"; json_content: ".logid","0100020233"; reference:url,docs.fortinet.com/document/fortigate/7.4.0/new-features/226732/real-time-file-system-integrity-checking; classtype:malware; sid:5014484; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[FORTINET] Administrator Login from External IP address"; json_content: ".logid", "0100032001"; json_pcre: ".msg", "/from\s\w+\((\d+)(?<!10)\.(\d+)(?<!192\.168)(?<!172\.(1[6-9]|2\d|3[0-1]))\.(\d+)\.(\d+)/"; classtype:successful-admin; sid:5014485; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM Virus Event Detected (Catch All)"; json_content: ".type", "utm"; json_content: ".subtype", "virus"; json_meta_content: !".level", notice,information; json_meta_content: !".logid", 0211008192,0211008193; json_meta_content: !".eventtype", "analytics"; json_map: "src_ip", ".srcip"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014486; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM Multiple Webfilter Events Detect from a Single Source [250/1]"; json_content: ".type", "utm"; json_content: ".subtype", "webfilter"; json_meta_content:".catdesc", File|20|Sharing|20|and|20|Storage,Remote|20|Access,Child|20|Sexual|20|Abuse,Crypto|20|Mining,Hacking,Terrorism,Potentially|20|Unwanted|20|Program,Dynamic|20|DNS,Malicious|20|Websites,Newly|20|Observed|20|Domain,Newly|20|Registered|20|Domain,Phishing,Spam|20|URLs,Unrated,Not|20|Rated; json_meta_content: !".catdesc",Advertising,Freeware,Meaningless,File|20|Sharing,Instant|20|Messaging; json_pcre: ".srcip", "/((10\.(\d{1,3}\.){2}\d{1,3})|(172\.(1[6-9]|2[0-9]|3[0-2])(\.\d{1,3}){2})|(192\.168(\.\d{1,3}){2}))/"; json_pcre: ".dstip", "/(!(10\.(\d{1,3}\.){2}\d{1,3})|(172\.(1[6-9]|2[0-9]|3[0-2])(\.\d{1,3}){2})|(192\.168(\.\d{1,3}){2}))/"; json_content: !".eventtype", "ftgd_allow"; json_meta_content:!".crlevel", low,medium; json_content:!".severity", "low"; json_meta_content:!".level", notice,information; content:!".tiktokv.com"; content:!".tiktokcdn-us.com"; content:!"Microsoft-WebDAV-MiniRedir"; content: !"Microsoft-Delivery-Optimization"; meta_content: !"%sagan%",|2e|gov,|2e|edu|2e|local,collector|2e|azure|2e|microsoft|2e|scloud; content:!".live.net"; content:!"oneclient.sfx.ms"; content:!".delivery.mp.microsoft.com"; content:!"icloud.com"; after:track by_src,count 250, seconds 7200; threshold:type suppress, track by_src, count 1, seconds 86400; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014487; rev:5; metadata:updated_at 2024_06_05;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM emailfilter Event Detected"; json_content: ".type", "utm"; json_content: ".subtype", "emailfilter"; json_content: !".severity", "low"; json_meta_content: !".level", notice,information; json_map: "src_ip", ".srcip"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014488; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM app-ctl Event Detected"; json_content: ".type", "utm"; json_content: ".subtype", "app-ctl"; json_content: !".severity", "low";  json_meta_content: !".level", information,notice; json_meta_content: !".apprisk", low,medium; json_map: "src_ip", ".srcip"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014489; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM WAF Event Detected"; json_content: ".type", "utm"; json_content: ".subtype", "waf"; json_content: !".severity", "low"; json_content: !".level", "low"; json_map: "src_ip", ".srcip"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014490; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM WAF Custom Event Detected"; json_content: ".type", "utm"; json_content: ".subtype", "waf"; json_content: ".eventtype", "waf-custom-signature"; json_map: "src_ip", ".srcip"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014491; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM gtp Event Detected"; json_content: ".type", "utm"; json_content: ".subtype", "gtp"; json_content: !".severity", "low"; json_content: !".level", "low"; json_map: "src_ip", ".srcip"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014492; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM dns Event Detected"; json_content: ".type", "utm"; json_content: ".subtype", "dns"; json_meta_content: ".catdesc", File|20|Sharing|20|and|20|Storage,Remote|20|Access,Child|20|Sexual|20|Abuse,Crypto|20|Mining,Hacking,Terrorism,Dynamic|20|DNS,Malicious|20|Websites,Newly|20|Registered|20|Domain,Phishing,Unrated,Not|20|Rated; json_content: !".action", "redirect"; json_content: !".severity", "low"; json_content: !".level", "low"; content:!".live.net"; content:!"oneclient.sfx.ms"; content:!".delivery.mp.microsoft.com"; content:!"icloud.com"; meta_content:!"%sagan%",|2e|local,|2e|internal,wpad|2e|; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; reference:url,https://community.fortinet.com/t5/FortiGate/Troubleshooting-Tip-DNS-Filter-profile-Redirect-to-Fortinet/ta-p/227243; sid:5014493; rev:4; metadata:updated_at 2024_05_16;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM ssh Event Detected"; json_content: ".type", "utm"; json_content: ".subtype", "ssh"; json_content: !".severity", "low"; json_content: !".level", "low"; json_map: "src_ip", ".srcip"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014494; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM ssl Event Detected"; json_content: ".type", "utm"; json_content: ".subtype", "ssl"; json_content: !".severity", "low"; json_content: !".level", "low"; json_map: "src_ip", ".srcip"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014495; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM file-filter Event Detected"; json_content: ".type", "utm"; json_content: ".subtype", "file-filter"; json_content: !".severity", "low"; json_content: !".level", "low"; json_content: !".hostname", "adl.windows.com"; content:!".windowsupdate.com"; json_content: !".hostname", "edgedl.me.gvt1.com"; meta_content: !"%sagan%", Microsoft-WebDAV-MiniRedir,Microsoft-Delivery-Optimization; json_map: "src_ip", ".srcip"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014496; rev:2; metadata: updated_on 2024_06_05;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM icap Event Detected"; json_content: ".type", "utm"; json_content: ".subtype", "icap"; json_content: !".severity", "low"; json_content: !".level", "low"; json_map: "src_ip", ".srcip"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014497; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM forti-switch Event Detected"; json_content: ".type", "utm"; json_content: ".subtype", "forti-switch"; json_content: !".severity", "low"; json_content: !".level", "low"; json_map: "src_ip", ".srcip"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014498; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM virtual-patch Event Detected"; json_content: ".type", "utm"; json_content: ".subtype", "virtual-patch"; json_content: !".severity", "low"; json_content: !".level", "low"; json_map: "src_ip", ".srcip"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014499; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM casb Event Detected"; json_content: ".type", "utm"; json_content: ".subtype", "casb"; json_content: !".severity", "low"; json_content: !".level", "low"; json_map: "src_ip", ".srcip"; classtype:system-event; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014500; rev:1;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] UTM dns Event Detected - Possible C2 Traffic [250/1]"; json_content: ".type", "utm"; json_content: ".subtype", "dns"; json_meta_content:".catdesc" ,File|20|Sharing|20|and|20|Storage,Remote|20|Access,Child|20|Sexual|20|Abuse,Crypto|20|Mining,Hacking,Terrorism,Potentially|20|Unwanted|20|Program,Dynamic|20|DNS,Malicious|20|Websites,Newly|20|Observed|20|Domain,Newly|20|Registered|20|Domain,Phishing,Spam|20|URLs,Unrated,Not|20|Rated; json_content: !".severity", "low"; json_content: !".level", "low"; content:!".live.net"; content:!"oneclient.sfx.ms"; content:!".delivery.mp.microsoft.com"; content:!"icloud.com"; meta_content:!"%sagan%",|2e|local,|2e|internal,wpad|2e|; json_map: "src_ip", ".srcip"; json_map: "dest_ip", ".dstip"; after:track by_src,count 250, seconds 7200; threshold:type suppress, track by_src, count 1, seconds 86400 classtype:suspicious-traffic; reference:url,https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/efa7b0eb-45bc-11ee-8e6d-fa163e15d75b/FortiOS_7.4.1_Log_Reference.pdf; sid:5014501; rev:1; metadata:updated_at 2024_05_16;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Possible FortiManager Compromise - Unregistered Device - CVE-2024-47575"; json_content:".type", "event"; json_content: ".subtype", "dvm"; content:"Unregistered device"; nocase; content:"add succeeded"; nocase; json_map: "src_ip", ".srcip"; normalize; reference:url,https://socradar.io/fortimanager-zero-day-fortijump-is-now-publicly-addressed-cve-2024-47575/; reference:url,https://fortiguard.fortinet.com/psirt/FG-IR-24-423; classtype:suspicious-traffic; sid:5014502; rev:1; metadata:created_at 2024_10_24, updated_at 2024_10_24;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[FORTINET] Possible FortiManager Compromise - Modify Device - CVE-2024-47575"; json_content: ".type", "event"; json_content: ".subtype", "dvm"; json_content: ".adom", "root"; json_nocase; content:"Edited device settings"; nocase; json_map: "src_ip", ".srcip"; normalize; reference:url,https://socradar.io/fortimanager-zero-day-fortijump-is-now-publicly-addressed-cve-2024-47575/; reference:url,https://fortiguard.fortinet.com/psirt/FG-IR-24-423; classtype:trojan-activity; sid:5014503; rev:1; metadata:created_at 2024_10_24, updated_at 2024_10_24;)

alert any any any -> any any (msg: "[FORTINET] DNS Request to Monitored Domain Detected";  json_content: ".logid", "1501054802"; json_content: ".msg", "Domain is monitored"; json_content: ".action", "pass"; json_map: "src_ip", ".srcip"; json_meta_content: ".catdesc", Instant Messaging,File Sharing and Storage,Freeware and Software Downloads,Remote Access,Malicious Websites,Proxy Avoidance,Illegal or Unethical,Hacking,Crypto Mining,Child Sexual Abuse,Gambling,Nudity and Risque,Pornography,Peer-to-peer File Sharing,URL Shortening,Potentially Unwanted Program; json_meta_nocase; classtype: suspicious-traffic; sid:5015494; rev:3;)
