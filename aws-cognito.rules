# Sagan aws-cognito.rules
# Copyright (c) 2009-2023. Quadrant Information Security <www.quadrantsec.com>
# All rights reserved.
#
# Please submit any custom rules or ideas to sagan-submit@quadrantsec.com or the sagan-sigs mailing list
#
#*************************************************************
#  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the
#  following conditions are met:
#
#  * Redistributions of source code must retain the above copyright notice, this list of conditions and the following
#    disclaimer.
#  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the
#    following disclaimer in the documentation and/or other materials provided with the distribution.
#  * Neither the name of the nor the names of its contributors may be used to endorse or promote products derived
#    from this software without specific prior written permission.
#
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES,
#  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
#  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
#  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
#  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
#  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
#  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
#*************************************************************

# rules by "Bryant Smith" <bsmith@quadrantsec.com>
# 04/26/2023


alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AddCustomAttributes) "; program:cognito*; content:"eventName|22 3a 20 22|AddCustomAttributes"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011969; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminAddUserToGroup) "; program:cognito*; content:"eventName|22 3a 20 22|AdminAddUserToGroup"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011970; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminConfirmSignUp) "; program:cognito*; content:"eventName|22 3a 20 22|AdminConfirmSignUp"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011971; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminCreateUser) "; program:cognito*; content:"eventName|22 3a 20 22|AdminCreateUser"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011972; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminDeleteUser) "; program:cognito*; content:"eventName|22 3a 20 22|AdminDeleteUser"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011973; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminDeleteUserAttributes) "; program:cognito*; content:"eventName|22 3a 20 22|AdminDeleteUserAttributes"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011974; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminDisableProviderForUser) "; program:cognito*; content:"eventName|22 3a 20 22|AdminDisableProviderForUser"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011975; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminDisableUser) "; program:cognito*; content:"eventName|22 3a 20 22|AdminDisableUser"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011976; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminEnableUser) "; program:cognito*; content:"eventName|22 3a 20 22|AdminEnableUser"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011977; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminForgetDevice) "; program:cognito*; content:"eventName|22 3a 20 22|AdminForgetDevice"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011978; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminGetDevice) "; program:cognito*; content:"eventName|22 3a 20 22|AdminGetDevice"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011979; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminGetUser) "; program:cognito*; content:"eventName|22 3a 20 22|AdminGetUser"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011980; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminInitiateAuth) "; program:cognito*; content:"eventName|22 3a 20 22|AdminInitiateAuth"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011981; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminLinkProviderForUser) "; program:cognito*; content:"eventName|22 3a 20 22|AdminLinkProviderForUser"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011982; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminListDevices) "; program:cognito*; content:"eventName|22 3a 20 22|AdminListDevices"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011983; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminListGroupsForUser) "; program:cognito*; content:"eventName|22 3a 20 22|AdminListGroupsForUser"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011984; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminListUserAuthEvents) "; program:cognito*; content:"eventName|22 3a 20 22|AdminListUserAuthEvents"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011985; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminRemoveUserFromGroup) "; program:cognito*; content:"eventName|22 3a 20 22|AdminRemoveUserFromGroup"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011986; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminResetUserPassword) "; program:cognito*; content:"eventName|22 3a 20 22|AdminResetUserPassword"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011987; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminRespondToAuthChallenge) "; program:cognito*; content:"eventName|22 3a 20 22|AdminRespondToAuthChallenge"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011988; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminSetUserMFAPreference) "; program:cognito*; content:"eventName|22 3a 20 22|AdminSetUserMFAPreference"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011989; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminSetUserPassword) "; program:cognito*; content:"eventName|22 3a 20 22|AdminSetUserPassword"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011990; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminSetUserSettings) "; program:cognito*; content:"eventName|22 3a 20 22|AdminSetUserSettings"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011991; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminUpdateAuthEventFeedback) "; program:cognito*; content:"eventName|22 3a 20 22|AdminUpdateAuthEventFeedback"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011992; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminUpdateDeviceStatus) "; program:cognito*; content:"eventName|22 3a 20 22|AdminUpdateDeviceStatus"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011993; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminUpdateUserAttributes) "; program:cognito*; content:"eventName|22 3a 20 22|AdminUpdateUserAttributes"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011994; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AdminUserGlobalSignOut) "; program:cognito*; content:"eventName|22 3a 20 22|AdminUserGlobalSignOut"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011995; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (AssociateSoftwareToken) "; program:cognito*; content:"eventName|22 3a 20 22|AssociateSoftwareToken"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011996; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (ChangePassword) "; program:cognito*; content:"eventName|22 3a 20 22|ChangePassword"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011997; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (ConfirmDevice) "; program:cognito*; content:"eventName|22 3a 20 22|ConfirmDevice"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011998; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (ConfirmForgotPassword) "; program:cognito*; content:"eventName|22 3a 20 22|ConfirmForgotPassword"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5011999; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (ConfirmSignUp) "; program:cognito*; content:"eventName|22 3a 20 22|ConfirmSignUp"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012000; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (CreateGroup) "; program:cognito*; content:"eventName|22 3a 20 22|CreateGroup"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012001; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (CreateIdentityProvider) "; program:cognito*; content:"eventName|22 3a 20 22|CreateIdentityProvider"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012002; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (CreateResourceServer) "; program:cognito*; content:"eventName|22 3a 20 22|CreateResourceServer"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012003; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (CreateUserImportJob) "; program:cognito*; content:"eventName|22 3a 20 22|CreateUserImportJob"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012004; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (CreateUserPool) "; program:cognito*; content:"eventName|22 3a 20 22|CreateUserPool"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012005; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (CreateUserPoolClient) "; program:cognito*; content:"eventName|22 3a 20 22|CreateUserPoolClient"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012006; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (CreateUserPoolDomain) "; program:cognito*; content:"eventName|22 3a 20 22|CreateUserPoolDomain"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012007; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (DeleteGroup) "; program:cognito*; content:"eventName|22 3a 20 22|DeleteGroup"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012008; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (DeleteIdentityProvider) "; program:cognito*; content:"eventName|22 3a 20 22|DeleteIdentityProvider"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012009; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (DeleteResourceServer) "; program:cognito*; content:"eventName|22 3a 20 22|DeleteResourceServer"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012010; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (DeleteUser) "; program:cognito*; content:"eventName|22 3a 20 22|DeleteUser"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012011; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (DeleteUserAttributes) "; program:cognito*; content:"eventName|22 3a 20 22|DeleteUserAttributes"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012012; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (DeleteUserPool) "; program:cognito*; content:"eventName|22 3a 20 22|DeleteUserPool"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012013; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (DeleteUserPoolClient) "; program:cognito*; content:"eventName|22 3a 20 22|DeleteUserPoolClient"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012014; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (DeleteUserPoolDomain) "; program:cognito*; content:"eventName|22 3a 20 22|DeleteUserPoolDomain"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012015; rev:3;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (DescribeIdentityProvider) "; program:cognito*; content:"eventName|22 3a 20 22|DescribeIdentityProvider"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012016; rev:3;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (DescribeResourceServer) "; program:cognito*; content:"eventName|22 3a 20 22|DescribeResourceServer"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012017; rev:3;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (DescribeRiskConfiguration) "; program:cognito*; content:"eventName|22 3a 20 22|DescribeRiskConfiguration"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012018; rev:3;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (DescribeUserImportJob) "; program:cognito*; content:"eventName|22 3a 20 22|DescribeUserImportJob"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012019; rev:3;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (DescribeUserPool) "; program:cognito*; content:"eventName|22 3a 20 22|DescribeUserPool"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012020; rev:3;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (DescribeUserPoolClient) "; program:cognito*; content:"eventName|22 3a 20 22|DescribeUserPoolClient"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012021; rev:3;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (DescribeUserPoolDomain) "; program:cognito*; content:"eventName|22 3a 20 22|DescribeUserPoolDomain"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012022; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (ForgetDevice) "; program:cognito*; content:"eventName|22 3a 20 22|ForgetDevice"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012023; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (ForgotPassword) "; program:cognito*; content:"eventName|22 3a 20 22|ForgotPassword"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012024; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (GetCSVHeader) "; program:cognito*; content:"eventName|22 3a 20 22|GetCSVHeader"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012025; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (GetDevice) "; program:cognito*; content:"eventName|22 3a 20 22|GetDevice"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012026; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (GetGroup) "; program:cognito*; content:"eventName|22 3a 20 22|GetGroup"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012027; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (GetIdentityProviderByIdentifier) "; program:cognito*; content:"eventName|22 3a 20 22|GetIdentityProviderByIdentifier"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012028; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (GetSigningCertificate) "; program:cognito*; content:"eventName|22 3a 20 22|GetSigningCertificate"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012029; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (GetUICustomization) "; program:cognito*; content:"eventName|22 3a 20 22|GetUICustomization"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012030; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (GetUser) "; program:cognito*; content:"eventName|22 3a 20 22|GetUser"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012031; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (GetUserAttributeVerificationCode) "; program:cognito*; content:"eventName|22 3a 20 22|GetUserAttributeVerificationCode"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012032; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (GetUserPoolMfaConfig) "; program:cognito*; content:"eventName|22 3a 20 22|GetUserPoolMfaConfig"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012033; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (GlobalSignOut) "; program:cognito*; content:"eventName|22 3a 20 22|GlobalSignOut"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012034; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (InitiateAuth) "; program:cognito*; content:"eventName|22 3a 20 22|InitiateAuth"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012035; rev:3;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (ListDevices) "; program:cognito*; content:"eventName|22 3a 20 22|ListDevices"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012036; rev:3;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (ListGroups) "; program:cognito*; content:"eventName|22 3a 20 22|ListGroups"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012037; rev:3;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (ListIdentityProviders) "; program:cognito*; content:"eventName|22 3a 20 22|ListIdentityProviders"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012038; rev:3;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (ListResourceServers) "; program:cognito*; content:"eventName|22 3a 20 22|ListResourceServers"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012039; rev:3;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (ListTagsForResource) "; program:cognito*; content:"eventName|22 3a 20 22|ListTagsForResource"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012040; rev:3;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (ListUserImportJobs) "; program:cognito*; content:"eventName|22 3a 20 22|ListUserImportJobs"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012041; rev:3;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (ListUserPoolClients) "; program:cognito*; content:"eventName|22 3a 20 22|ListUserPoolClients"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012042; rev:3;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (ListUserPools) "; program:cognito*; content:"eventName|22 3a 20 22|ListUserPools"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012043; rev:3;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (ListUsers) "; program:cognito*; content:"eventName|22 3a 20 22|ListUsers"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012044; rev:3;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (ListUsersInGroup) "; program:cognito*; content:"eventName|22 3a 20 22|ListUsersInGroup"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012045; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (ResendConfirmationCode) "; program:cognito*; content:"eventName|22 3a 20 22|ResendConfirmationCode"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012046; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (RespondToAuthChallenge) "; program:cognito*; content:"eventName|22 3a 20 22|RespondToAuthChallenge"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012047; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (RevokeToken) "; program:cognito*; content:"eventName|22 3a 20 22|RevokeToken"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012048; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (SetRiskConfiguration) "; program:cognito*; content:"eventName|22 3a 20 22|SetRiskConfiguration"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012049; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (SetUICustomization) "; program:cognito*; content:"eventName|22 3a 20 22|SetUICustomization"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012050; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (SetUserMFAPreference) "; program:cognito*; content:"eventName|22 3a 20 22|SetUserMFAPreference"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012051; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (SetUserPoolMfaConfig) "; program:cognito*; content:"eventName|22 3a 20 22|SetUserPoolMfaConfig"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012052; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (SetUserSettings) "; program:cognito*; content:"eventName|22 3a 20 22|SetUserSettings"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012053; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (SignUp) "; program:cognito*; content:"eventName|22 3a 20 22|SignUp"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012054; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (StartUserImportJob) "; program:cognito*; content:"eventName|22 3a 20 22|StartUserImportJob"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012055; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (StopUserImportJob) "; program:cognito*; content:"eventName|22 3a 20 22|StopUserImportJob"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012056; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (TagResource) "; program:cognito*; content:"eventName|22 3a 20 22|TagResource"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012057; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (UntagResource) "; program:cognito*; content:"eventName|22 3a 20 22|UntagResource"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012058; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (UpdateAuthEventFeedback) "; program:cognito*; content:"eventName|22 3a 20 22|UpdateAuthEventFeedback"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012059; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (UpdateDeviceStatus) "; program:cognito*; content:"eventName|22 3a 20 22|UpdateDeviceStatus"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012060; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (UpdateGroup) "; program:cognito*; content:"eventName|22 3a 20 22|UpdateGroup"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012061; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (UpdateIdentityProvider) "; program:cognito*; content:"eventName|22 3a 20 22|UpdateIdentityProvider"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012062; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (UpdateResourceServer) "; program:cognito*; content:"eventName|22 3a 20 22|UpdateResourceServer"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012063; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (UpdateUserAttributes) "; program:cognito*; content:"eventName|22 3a 20 22|UpdateUserAttributes"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012064; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (UpdateUserPool) "; program:cognito*; content:"eventName|22 3a 20 22|UpdateUserPool"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012065; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (UpdateUserPoolClient) "; program:cognito*; content:"eventName|22 3a 20 22|UpdateUserPoolClient"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012066; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (UpdateUserPoolDomain) "; program:cognito*; content:"eventName|22 3a 20 22|UpdateUserPoolDomain"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012067; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (VerifySoftwareToken) "; program:cognito*; content:"eventName|22 3a 20 22|VerifySoftwareToken"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012068; rev:3;)
alert any $HOME_NET any -> $HOME_NET any (msg:"[AWS-COGNITO] AWS Cognito event detected (VerifyUserAttribute) "; program:cognito*; content:"eventName|22 3a 20 22|VerifyUserAttribute"; content:!"|22|sourceIPAddress|22 3a 20 22|config|2e|amazonaws|2e|com|22|"; content:!"|22|mfaAuthenticated|22 3a 20 22|true|22|"; classtype:system-event; reference:url,docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_Operations.html; sid:5012069; rev:3;)
