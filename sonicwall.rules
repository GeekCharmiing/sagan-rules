# Sagan sonicwall.rules
# Copyright (c) 2009-2023. Quadrant Information Security <www.quadrantsec.com>
# All rights reserved.
#
# Please submit any custom rules or ideas to sagan-submit@quadrantsec.com or the sagan-sigs mailing list
#
#*************************************************************
#  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the
#  following conditions are met:
#
#  * Redistributions of source code must retain the above copyright notice, this list of conditions and the following
#    disclaimer.
#  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the
#    following disclaimer in the documentation and/or other materials provided with the distribution.
#  * Neither the name of the nor the names of its contributors may be used to endorse or promote products derived
#    from this software without specific prior written permission.
#
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES,
#  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
#  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
#  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
#  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
#  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
#  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
#*************************************************************

#Reference: https://www.sonicwall.com/techdocs/pdf/sonicos-6-5-4-log-events-reference-guide.pdf

alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[SONICWALL] Possible TCP Port Scan"; content: "Possible port scan detected"; content: "TCP scanned port list"; default_proto: tcp; parse_src_ip: 2; parse_dst_ip: 3; normalize; classtype: network-scan; sid: 5001083; rev:4;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[SONICWALL] Possible UDP Port Scan"; content: "Possible port scan detected"; content: "UDP scanned port list"; default_proto: udp; parse_src_ip: 2; parse_dst_ip: 3; normalize; classtype: network-scan; sid: 5001085; rev:4;)

#alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[SONICWALL] IPS Detection Alert"; content: "IPS Detection Alert"; content: "ICMP PING"; default_proto: icmp; normalize; classtype: network-scan; sid: 5001084; rev:3;)

# Jeff Ward states that the below rule only triggers on ICMP traffic (all of it).  Be adviced to disable completely.
# - Champ Clark 2020/0519
#
#alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[SONICWALL] IPS Detection Alert [0/5]"; content: "IPS Detection Alert"; threshold: type suppress, track by_src, count 5, seconds 300; default_proto: icmp; normalize; classtype: network-scan; sid: 5001090; rev:5;)

# These where created by Kevin Gross (kgross@quadrantsec.com)

#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Possible restart for system maintenance"; content: "As per Diagnostic Auto-restart configuration request, restarting system"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002601; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Auto-Dial Failure"; content: "auto-dial failed: Current Connection Model is configured as Ethernet Only"; normalize; classtype: system-event; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002602; rev:3;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Ethernet Port Down"; content: "Ethernet Port Down"; normalize; classtype: hardware-event; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002603; rev:3;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Ethernet Port Up"; content: "Ethernet Port Up"; normalize; classtype: hardware-event; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002604; rev:3;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Registration Update Needed"; content: "Registration Update Needed"; content: "Restore your existing security service subscRIPtions by clicking"; normalize; classtype: system-event; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002605; rev:3;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] 3G Device Detected"; content: "3G"; content: "device detected"; normalize; classtype: hardware-event; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002606; rev:3;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] 3G Data Limit Reached"; content: "3G"; content: "data usage limit reached"; normalize; classtype: system-event; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002607; rev:3;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] No 3G Sim Card Detected"; content: "3G"; content: "No SIM detected"; normalize; classtype: hardware-event; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002608; rev:3;)

# This rule's content is bad, bad. 
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Preferences File Inaccessable"; content: "A prior version of preferences was loaded because the most recent preferences file was inaccessible"; normalize; classtype: system-event; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002609; rev:3;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] OS Upgrade Performed"; content: "A SonicOS Standard to Enhanced Upgrade was performed"; normalize; classtype: system-event; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002610; rev:3;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Attempted access from host out of compliance with GSC policy"; content: "Access attempt from host out of compliance with GSC policy"; normalize; classtype: configuration-error; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002611; rev:4;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Access attempt from host without Anti-Virus agent installed"; content:"Access attempt from host without Anti-Virus agent installed"; normalize; classtype: configuration-error; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002612; rev:4;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Accept attempt from host without GSC"; content: "Access attempt from host without GSC installed"; normalize; classtype: configuration-error; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002613; rev:3;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Firewall Rule Added"; content: "Access rule added"; normalize; classtype: configuration-change; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002614; rev:3;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Firewall Rule Deleted"; content: "Access rule deleted"; normalize; classtype: configuration-change; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002615; rev:3;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Firewall Rule Modified"; content: "Access rule modified"; normalize; classtype: configuration-change; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002616; rev:3;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Firewall Rule reset to defaults"; content: "Access rules restored to defaults"; normalize; classtype: configuration-change; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002617; rev:3;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Network Access to proxy server denied"; content: "Access to proxy server denied"; normalize; classtype: permissions-violation; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002618; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] ActiveX access denied"; content: "ActiveX access denied"; normalize; classtype: suspicious-traffic; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002619; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] ActiveX or Java archive access denied"; content: "ActiveX or Java archive access denied"; normalize; classtype: suspicious-traffic; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002620; rev:3;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Successful Administrator Access"; content: "Administrator login allowed"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002621; rev:5;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Administrator Access denied due to bad credentials"; content: "Administrator login denied due to bad credentials"; normalize; classtype: unsuccessful-admin; parse_src_ip: 2; parse_dst_ip: 3; after: track by_src, count 5, seconds 300; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002622; rev:3;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Administrator Access not allowed on this interface"; content: "Administrator login denied from"; content: "logins disabled from this interface"; normalize; classtype: unsuccessful-admin; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002623; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Administrator Account Name Changed"; content: "Administrator name changed"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002624; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Firewall preferences reset to factory defaults"; content: "All preference values have been set to factory default values"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002625; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Allowed LDAP server certificate with wrong host name"; content: "Allowed LDAP server certificate with wrong host name"; normalize; classtype: unsuccessful-admin; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002626; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Possible Intrusion detection - Anti-Spyware detected"; content: "Anti-Spyware Detection Alert"; normalize; classtype: suspicious-traffic; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002627; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Possible Intrusion detection - Anti-Spyware detected"; content: "Anti-Spyware Prevention Alert"; normalize; classtype: suspicious-traffic; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002628; rev:4;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Suspicious Application detected"; content: "Application Filter Detection Alert"; normalize; classtype: suspicious-traffic; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002629; rev:3;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Suspicious Application detected"; content: "Application Filters Block Alert"; normalize; classtype: suspicious-traffic; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002630; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] ASOC Flood detected from WLAN station"; content: "Association Flood from WLAN station"; normalize; classtype: exploit-attempt; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002631; rev:3;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Back Orifice Attack Dropped"; content: "Back Orifice attack dropped"; normalize; classtype: exploit-attempt; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002632; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] High Availability - Backup active"; content: "Backup active"; normalize; classtype: hardware-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002633; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] High Availability/Failover - Backup Firewall Active"; content: "Backup firewall has transitioned to Active"; normalize; classtype: hardware-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002634; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] High Availability/Failover - Backup Firewall transitioned to idle"; content: "Backup firewall has transitioned to Idle"; normalize; classtype: hardware-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002635; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] High Availability - Backup Firewall Rebooting"; content: "Backup firewall rebooting itself as it transitioned from Active to Idle while Preempt"; normalize; classtype: hardware-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002636; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] High Availability - Backup WAN link down"; content: "Backup WAN link down, Primary going Active"; normalize; classtype: hardware-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002637; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] VPN PKI - Bad CRL format"; content: "Bad CRL format"; normalize; classtype: suspicious-traffic; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002638; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] VPN PKI - Blacklisted Certificate"; content: "Certificate on Revoked list(CRL)"; normalize; classtype: suspicious-traffic; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002639; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Administrator Login - Commandline login successful"; content: "CLI administrator login allowed"; normalize; classtype: successful-admin; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002640; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Administrator login failed due to bad credentials"; content: "CLI administrator login denied due to bad credentials"; normalize; classtype: unsuccessful-admin; parse_src_ip: 2; parse_dst_ip: 1; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002641; rev:3;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Firewall event - Diagnostic Reboot"; content: "Diagnostic Auto-restart scheduled for"; normalize; classtype: hardware-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002642; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Firewall Hardware Diagnostic Code A"; content: "Diagnostic Code A"; normalize; classtype: hardware-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002643; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Firewall Hardware Diagnostic Code B"; content: "Diagnostic Code B"; normalize; classtype: hardware-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002644; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Firewall Hardware Diagnostic Code C"; content: "Diagnostic Code C"; normalize; classtype: hardware-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002645; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Firewall Hardware Diagnostic Code D"; content: "Diagnostic Code D"; normalize; classtype: hardware-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002646; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Firewall Hardware Diagnostic Code E"; content: "Diagnostic Code E"; normalize; classtype: hardware-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002647; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Firewall Hardware Diagnostic Code F"; content: "Diagnostic Code F"; normalize; classtype: hardware-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002648; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Firewall Hardware Diagnostic Code G"; content: "Diagnostic Code G"; normalize; classtype: hardware-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002649; rev:3;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Firewall Hardware Diagnostic Code H"; content: "Diagnostic Code H"; normalize; classtype: hardware-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002650; rev:4;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Firewall Hardware Diagnostic Code I"; content: "Diagnostic Code I"; normalize; classtype: hardware-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002651; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Firewall Hardware Diagnostic Code J"; content: "Diagnostic Code J"; normalize; classtype: hardware-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002652; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection Non-Sonicpoint WLAN traffic dropped"; content: "Drop WLAN traffic from nonSonicPoint devices"; normalize; classtype: exploit-attempt; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002653; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Error initializing Hardware acceleration for VPN"; content: "Error initializing Hardware acceleration for VPN"; normalize; classtype: hardware-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002654; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] High Availability - Error rebooting peer firewall"; content: "Error Rebooting HA Peer Firewall"; normalize; classtype: system-hardware; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002655; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] High Availability - Error setting up IP address of the backup"; content: "Error setting the IP address of the backup, please manually set to backup LAN IP"; normalize; classtype: hardware-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002656; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Security Services - License Sync Failed"; content: "Failed to synchronize license information with Licensing Server"; normalize; classtype: system-error; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002657; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Possible FIN Flood"; content: "FIN Flood Blacklist on"; normalize; classtype: attempted-dos; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002658; rev:3;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Possible FIN Flood"; content: "FIN-Flooding machine"; normalize; classtype: attempted-dos; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002659; rev:3;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] WLAN IDS - Rouge Access Point"; content: "Found Rogue Access Point"; normalize; classtype: exploit-attempt; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002660; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Fraudulent Microsoft Certificate"; content: "Fraudulent Microsoft certificate found"; normalize; classtype: exploit-attempt; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002661; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] FTP - Login Failed"; content: "FTP client user logged in failed"; normalize; classtype: unsuccessful-user; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002662; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Network Access - Dropped access from non-default port"; content: "Data connection from non default port dropped"; normalize; classtype: suspicious-traffic; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002663; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Bounce attack dropped"; content: "PASV response bounce attack dropped"; normalize; classtype: exploit-attempt; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002664; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Spoof attack dropped"; content: "PASV response spoof attack dropped"; normalize; classtype: exploit-attempt; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002665; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Guest account created"; content: "Guest account"; content: "created"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002666; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Guest account deleted"; content: "Guest account"; content: "deleted"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002667; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Guest account disabled"; content: "Guest account"; content: "disabled"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002668; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Guest account pruned"; content: "Guest account"; content: "pruned"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002669; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Guest account re-enabled"; content: "Guest account"; content: "re-enabled"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002670; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Guest account re-generated"; content: "Guest account"; content: "re-generated"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002671; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Heartbeat detected from incompatable source"; content: "Heartbeat received from incompatible source"; normalize; classtype: suspicious-traffic; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002672; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] HTTP management port has changed"; content: "HTTP management port has changed"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002673; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Wireless - Unauthorized user"; content: "Internet Access restricted to authorized users"; normalize; classtype: permissions-violation; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002674; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Possible IP spoof detected"; content: "IP spoof detected on packet to Central Gateway"; normalize; classtype: exploit-attempt; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002675; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Possible IP spoof dropped"; content: "IP spoof dropped"; normalize; classtype: exploit-attempt; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002676; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] IPS Detection Alert"; content: "IPS Detection Alert"; normalize; classtype: exploit-attempt; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002677; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] IPS Prevention Alert"; content: "IPS Prevention Alert"; normalize; classtype: exploit-attempt; parse_src_ip: 2; parse_dst_ip: 3; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002678; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Land attack dropped"; content: "Land attack dropped"; normalize; classtype: exploit-attempt; parse_src_ip: 2; parse_dst_ip: 3; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002679; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - removed from FIN flood blacklist"; content: "removed from FIN flood blacklist"; normalize; classtype: system-event; parse_src_ip: 2; parse_dst_ip: 3; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002680; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - removed from RST flood blacklist"; content: "removed from RST flood blacklist"; normalize; classtype: system-event; parse_src_ip: 2; parse_dst_ip: 3; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002681; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - removed from SYN flood blacklist"; content: "removed from SYN flood blacklist"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002682; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Firewall logging - Maximum events per second threshold exceeded"; content: "Maximum events per second threshold exceeded"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002683; rev:3;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] PPP dialup - Maximum sequential failed dial attempts"; content: "Maximum sequential failed dial attempts"; normalize; classtype: exploit-attempt; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002684; rev:3;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Firewall logging - Maximum syslog data per second threshold exceeded"; content: "Maximum syslog data per second threshold exceeded"; normalize; classtype: attempted-dos; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002685; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Multiple DHCP servers detected on network"; content: "Multiple DHCP Servers are detected on network"; normalize; classtype: network-event; parse_src_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002686; rev:3;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Net Spy attack dropped"; content: "Net Spy attack dropped"; normalize; classtype: exploit-attempt; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002687; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - NetBus attack dropped"; content: "NetBus attack dropped"; normalize; classtype: exploit-attempt; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002688; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Wireless - Packet dropped by WLAN"; content: "Packet dropped by WLAN"; normalize; classtype: suspicious-traffic; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002689; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] No firewall rule exists for VPN policy"; content: " No firewall rule associated with VPN policy"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002690; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Ping of Death dropped"; content: "Ping of death dropped"; normalize; classtype: exploit-attempt; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002691; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Possible DNS rebind attack detected"; content: "Possible DNS rebind attack detected"; normalize; classtype: exploit-attempt; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002692; rev:2;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[SONICWALL] Intrusion Detection - Possible FIN Flood"; content: "Possible FIN Flood"; normalize; classtype: attempted-dos; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002693; rev:5;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Possible port scan detected"; content: "Possible port scan detected"; normalize; classtype: network-scan ; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002694; rev:3;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Possible RST Flood"; content: "Possible RST Flood"; normalize; classtype: attempted-dos; threshold: type suppress, track by_src, count 1, seconds 300; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002695; rev:4;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Possible SYN Flood"; content: "Possible SYN Flood"; pcre:"/src\:\s(\d+)(?<!10)\.(\d+)(?<!192\.168)(?<!172\.(1[6-9]|2\d|3[0-1]))\.(\d+)\.(\d+)/"; normalize; classtype: attempted-dos; parse_src_ip: 2; parse_dst_ip: 3; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002696; rev:5; metadata: updatedon, 2024_07_19;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Priority attack dropped"; content: "Priority attack dropped"; normalize; classtype: exploit-attempt; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002697; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Probable port scan detected"; content: "Probable port scan detected"; normalize; classtype: network-scan; parse_src_ip: 2; parse_dst_ip: 3; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002698; rev:4;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Probable TCP FIN scan detected"; content: "Probable TCP FIN scan detected"; normalize; classtype: network-scan; parse_src_ip: 2; parse_dst_ip: 3; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002699; rev:4;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Probable TCP NULL scan detected"; content: "Probable TCP NULL scan detected"; normalize; classtype: network-scan; parse_src_ip: 2; parse_dst_ip: 3; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002700; rev:4;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Probable TCP XMAS scan detected"; content: "Probable TCP XMAS scan detected"; normalize; classtype: network-scan; parse_src_ip: 2; parse_dst_ip: 3; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002701; rev:4;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Wan Failover - Possible recon attempt"; content: "Probing failure on"; normalize; classtype: attempted-recon; parse_src_ip: 2; parse_dst_ip: 3; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002702; rev:4;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Wan Failover - Recon attempt"; content: "Probing suceeded on"; normalize; classtype: successful-recon-limited; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002703; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Firewall Hardware - Clock battery has failed"; content: "Real time clock battery failure Time values may be incorrect"; normalize; classtype: hardware-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002704; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Wan Failover - Possible recon"; content: "Probing suceeded on"; normalize; classtype: successful-recon-limited; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002705; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Sonicwall License Expired"; content: "SonicWALL"; content: "expired"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002706; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Firewall rebooting"; content: "Restarting SonicWALL"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002707; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - RIPper attack dropped"; content: "RIPper attack dropped"; normalize; classtype: exploit-attempt; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002708; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - RST Flood Blacklist"; content: "RST Flood Blacklist on IF"; normalize; classtype: attempted-dos; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002709; rev:3;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - RST Flood"; content: "RST"; content: "Flooding machine"; normalize; classtype: attempted-dos; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002710; rev:3;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Senna Spy attack dropped"; content: "Senna Spy attack dropped"; normalize; classtype: exploit-attempt; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002711; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Firewall activated"; content: "SonicWALL activated"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002712; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Firewall starting up"; content: "SonicWALL initializing"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002713; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] SonicWALL SSO agent is down"; content: "SonicWALL SSO agent is down"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002714; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] SonicWALL SSO agent is up"; content: "SonicWALL SSO agent is up"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002715; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Domain name too long"; content: "SonicWALL SSO agent returned domain name too long"; normalize; classtype: system-event; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002716; rev:3;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] SSO agent returned error"; content: "SonicWALL SSO agent returned error"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002717; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] User name too long"; content: "SonicWALL SSO agent returned user name too long"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002718; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Source routed IP packet dropped"; content: "Source routed IP packet dropped"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002719; rev:3;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Spank attack dropped"; content: "Spank attack multicast packet dropped"; normalize; classtype: suspicious-traffic; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002720; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] VPN policy enforced"; content: "VPN enforcement"; normalize; classtype: exploit-attempt; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002721; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Striker attack dropped"; content: "Striker attack dropped"; normalize; classtype: exploit-attempt; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002722; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - Sub Seven attack dropped"; content: "Sub Seven attack dropped"; normalize; classtype: exploit-attempt; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002723; rev:4;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - SYN Flood blacklisting enabled by user"; content: "SYN Flood blacklisting enabled by user"; normalize; classtype: attempted-dos; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002724; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - SYN flood ceased or flooding machines blacklisted"; content: "SYN flood ceased or flooding machines blacklisted"; normalize; classtype: attempted-dos; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002725; rev:3;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - SYN Flood Mode changed by user"; content: "SYN Flood Mode changed by user to"; normalize; classtype: attempted-dos; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002726; rev:3;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] System clock manually updated"; content: "System clock manually updated"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002727; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Intrusion Detection - TCP Xmas Tree dropped"; content: "TCP Xmas Tree dropped"; normalize; classtype: network-scan; parse_src_ip: 2; parse_dst_ip: 3; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002728; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Virtual Access Point is disabled"; content: "Virtual Access Point is disabled"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002729; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Virtual Access Point is enabled"; content: "Virtual Access Point is enabled"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002730; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Hardware failure - Voltages Out of Tolerance"; content: "Voltages Out of Tolerance"; normalize; classtype: hardware-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002731; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] WLAN firmware image has been updated"; content: "WLAN firmware image has been updated"; normalize; classtype: system-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002732; rev:2;)
alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] Radio frequency threat detected"; content: "WLAN radio frequency threat detected"; normalize; classtype: exploit-attempt; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002733; rev:2;)
#alert any $HOME_NET any -> $EXTERNAL_NET any (msg:"[SONICWALL] WLAN sequence number out of order - sequencing error/EMF interference/rogue AP"; content: "WLAN sequence number out of order"; normalize; classtype: network-event; parse_src_ip: 1; parse_dst_ip: 2; reference: url,www.sonicwall.com/downloads/SonicOS_Log_Event_Reference_Guide.pdf; sid:5002734; rev:2;)

#alert any $HOME_NET any -> $EXTERNAL_NET any (msg: "[SONICWALL] Gateway Anti-Virus Alert"; content: "m|3d|809"; content: "Gateway Anti-Virus Alert"; normalize; classtype: suspicious-traffic; parse_src_ip: 2; parse_dst_ip:3; reference: url,software.sonicwall.com/Manual/232-001655-00_Rev_A_SonicOS_Enhanced_5.1_Log_Event_Reference_Guide.pdf; sid:5003983; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[SONICWALL] IP Spoof Detected"; content: "IP Spoof Detected"; default_proto: tcp; parse_src_ip: 2; parse_dst_ip: 3; normalize; classtype:suspicious-traffic; sid:5012101; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[SONICWALL] Wrong Admin Password"; content: "Wrong Admin Password"; default_proto: tcp; parse_src_ip: 2; parse_dst_ip: 3; normalize; classtype:suspicious-traffic; sid:5012102; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[SONICWALL] Admin Login Disabled"; content: "Admin Login Disabled"; default_proto: tcp; parse_src_ip: 2; parse_dst_ip: 3; normalize; classtype:suspicious-traffic; sid:5012103; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[SONICWALL] Smurf Attack"; content: "Smurf Attack"; default_proto: tcp; parse_src_ip: 2; parse_dst_ip: 3; normalize; classtype:suspicious-traffic; sid:5012104; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[SONICWALL] Forbidden E-Mail Attachment"; content: "E-Mail Attachment"; default_proto: tcp; parse_src_ip: 2; parse_dst_ip: 3; normalize; classtype:suspicious-traffic; sid:5012105; rev:1;)
alert any $EXTERNAL_NET any -> $HOME_NET any (msg:"[SONICWALL] Using LDAP Without TLS"; content: "Using LDAP Without TLS"; default_proto: tcp; parse_src_ip: 2; parse_dst_ip: 3; normalize; classtype:suspicious-traffic; sid:5012106; rev:1;)

#=============================================================================
# There are 2 versions of the below rules: One for events sent in generic syslog and one for events sent in JSON. Created by Charles Goggins on 10/14/2024


alert any any any -> any any (msg: "[SONICWALL] VPN Radius Authentication Failed - Brute Force [3/1]"; content: "m=140 "; content: "fw_action="; parse_src_ip: 2; after: track by_src&by_string, count 3, seconds 60; threshold: type suppress, track by_src, count 1, seconds 3600; normalize; classtype: brute-force; reference: url,https://www.sonicwall.com/techdocs/pdf/SonicOS-X_7.0.1_LogEvents_ReferenceGuide.pdf; sid:5015138; rev:1;)

alert any any any -> any any (msg: "[SONICWALL] VPN Radius Authentication Failed - Brute Force [3/1]"; program: sonicwall; content: "|22|msgid|22 3a 20|140|2c|"; parse_src_ip: 1; after: track by_src&by_string, count 3, seconds 60; threshold: type suppress, track by_src, count 1, seconds 3600; normalize; classtype: brute-force; reference: url,https://www.sonicwall.com/techdocs/pdf/SonicOS-X_7.0.1_LogEvents_ReferenceGuide.pdf; sid:5015139; rev:1;)

alert any any any -> any any (msg: "[SONICWALL] VPN Login Detected for Admin User"; content: "m=235 "; content: "fw_action="; parse_src_ip: 2; normalize; classtype: system-event; reference: url,https://www.sonicwall.com/techdocs/pdf/SonicOS-X_7.0.1_LogEvents_ReferenceGuide.pdf; sid:5015140; rev:1;)

alert any any any -> any any (msg: "[SONICWALL] VPN Login Detected for Admin User"; program: sonicwall; content: "|22|msgid|22 3a 20|235|2c|"; parse_src_ip: 1; normalize; classtype: system-event; reference: url,https://www.sonicwall.com/techdocs/pdf/SonicOS-X_7.0.1_LogEvents_ReferenceGuide.pdf; sid:5015141; rev:1;)

alert any any any -> any any (msg: "[SONICWALL] Admin Login from External IP detected"; content: "m=236 "; content: "fw_action="; parse_src_ip: 2; normalize; classtype: system-event; reference: url,https://www.sonicwall.com/techdocs/pdf/SonicOS-X_7.0.1_LogEvents_ReferenceGuide.pdf; sid:5015142; rev:1;)

alert any any any -> any any (msg: "[SONICWALL] Admin Login from External IP detected"; program: sonicwall; content: "|22|msgid|22 3a 20|236|2c|"; parse_src_ip: 1; normalize; classtype: system-event; reference: url,https://www.sonicwall.com/techdocs/pdf/SonicOS-X_7.0.1_LogEvents_ReferenceGuide.pdf; sid:5015143; rev:1;)

alert any any any -> any any (msg: "[SONICWALL] User Login from External IP detected"; content: "m=238 "; content: "fw_action="; parse_src_ip: 2; normalize; classtype: system-event; reference: url,https://www.sonicwall.com/techdocs/pdf/SonicOS-X_7.0.1_LogEvents_ReferenceGuide.pdf; sid:5015144; rev:1;)

alert any any any -> any any (msg: "[SONICWALL] User Login from External IP detected"; program: sonicwall; content: "|22|msgid|22 3a 20|238|2c|"; parse_src_ip: 1; normalize; classtype: system-event; reference: url,https://www.sonicwall.com/techdocs/pdf/SonicOS-X_7.0.1_LogEvents_ReferenceGuide.pdf; sid:5015145; rev:1;)

alert any any any -> any any (msg: "[SONICWALL] VPN Login from Outside HOME_COUNTRY"; meta_content: "m=%sagan% ", 235,237; content: "fw_action="; parse_src_ip: 2; country_code: track by_src, isnot $HOME_COUNTRY; normalize; classtype: suspicious-traffic; reference: url,https://www.sonicwall.com/techdocs/pdf/SonicOS-X_7.0.1_LogEvents_ReferenceGuide.pdf; sid:5015146; rev:1;)

alert any any any -> any any (msg: "[SONICWALL] VPN Login from Outside HOME_COUNTRY"; program: sonicwall; meta_content: "|22|msgid|22 3a 20|%sagan%|2c|", 235,237; parse_src_ip: 1; country_code: track by_src, isnot $HOME_COUNTRY; normalize; classtype: system-event; reference: url,https://www.sonicwall.com/techdocs/pdf/SonicOS-X_7.0.1_LogEvents_ReferenceGuide.pdf; sid:5015147; rev:1;)

alert any any any -> any any (msg: "[SONICWALL] Radius Authentication Failed - Brute Force [3/1]"; content: "m=243 "; content: "fw_action="; parse_src_ip: 2; after: track by_src&by_string, count 3, seconds 60; threshold: type suppress, track by_src, count 1, seconds 3600; normalize; classtype: brute-force; reference: url,https://www.sonicwall.com/techdocs/pdf/SonicOS-X_7.0.1_LogEvents_ReferenceGuide.pdf; sid:5015148; rev:1;)

alert any any any -> any any (msg: "[SONICWALL] Radius Authentication Failed - Brute Force [3/1]"; program: sonicwall; content: "|22|msgid|22 3a 20|243|2c|"; parse_src_ip: 1; after: track by_src&by_string, count 3, seconds 60; threshold: type suppress, track by_src, count 1, seconds 3600; normalize; classtype: brute-force; reference: url,https://www.sonicwall.com/techdocs/pdf/SonicOS-X_7.0.1_LogEvents_ReferenceGuide.pdf; sid:5015149; rev:1;)

alert any any any -> any any (msg: "[SONICWALL] User Login from Unauthorized Location Detected"; content: "m=246 "; content: "fw_action="; parse_src_ip: 2; normalize; classtype: suspicious-traffic; reference: url,https://www.sonicwall.com/techdocs/pdf/SonicOS-X_7.0.1_LogEvents_ReferenceGuide.pdf; sid:5015150; rev:1;)

alert any any any -> any any (msg: "[SONICWALL] User Login from Unauthorized Location Detected"; program: sonicwall; content: "|22|msgid|22 3a 20|246|2c|"; parse_src_ip: 1; normalize; classtype: suspicious-traffic; reference: url,https://www.sonicwall.com/techdocs/pdf/SonicOS-X_7.0.1_LogEvents_ReferenceGuide.pdf; sid:5015151; rev:1;)

alert any any any -> any any (msg: "[SONICWALL] VPN Certificate Was Found on revocation List"; content: "m=279 "; content: "fw_action="; parse_src_ip: 2; normalize; classtype: system-event; reference: url,https://www.sonicwall.com/techdocs/pdf/SonicOS-X_7.0.1_LogEvents_ReferenceGuide.pdf; sid:5015152; rev:1;)

alert any any any -> any any (msg: "[SONICWALL] VPN Certificate Was Found on revocation List"; program: sonicwall; content: "|22|msgid|22 3a 20|279|2c|"; parse_src_ip: 1; normalize; classtype: system-event; reference: url,https://www.sonicwall.com/techdocs/pdf/SonicOS-X_7.0.1_LogEvents_ReferenceGuide.pdf; sid:5015153; rev:1;)

alert any any any -> any any (msg: "[SONICWALL] A Rogue Access Point Was Detected on the Network"; content: "m=546 "; content: "fw_action="; normalize; classtype: system-event; reference: url,https://www.sonicwall.com/techdocs/pdf/SonicOS-X_7.0.1_LogEvents_ReferenceGuide.pdf; sid:5015154; rev:1;)

alert any any any -> any any (msg: "[SONICWALL] A Rogue Access Point Was Detected on the Network"; program: sonicwall; content: "|22|msgid|22 3a 20|546|2c|"; normalize; classtype: system-event; reference: url,https://www.sonicwall.com/techdocs/pdf/SonicOS-X_7.0.1_LogEvents_ReferenceGuide.pdf; sid:5015155; rev:1;)

alert any any any -> any any (msg: "[SONICWALL] A Guest Account Was Created on Appliance"; content: "m=558 "; content: "fw_action="; normalize; classtype: system-event; reference: url,https://www.sonicwall.com/techdocs/pdf/SonicOS-X_7.0.1_LogEvents_ReferenceGuide.pdf; sid:5015156; rev:1;)

alert any any any -> any any (msg: "[SONICWALL] A Guest Account Was Created on Appliance"; program: sonicwall; content: "|22|msgid|22 3a 20|558|2c|"; normalize; classtype: system-event; reference: url,https://www.sonicwall.com/techdocs/pdf/SonicOS-X_7.0.1_LogEvents_ReferenceGuide.pdf; sid:5015157; rev:1;)

alert any any any -> any any (msg: "[SONICWALL] A Guest Account Was Re-Enabled on Appliance"; content: "m=561 "; content: "fw_action="; normalize; classtype: system-event; reference: url,https://www.sonicwall.com/techdocs/pdf/SonicOS-X_7.0.1_LogEvents_ReferenceGuide.pdf; sid:5015158; rev:1;)

alert any any any -> any any (msg: "[SONICWALL] A Guest Account Was Re-Enabled on Appliance"; program: sonicwall; content: "|22|msgid|22 3a 20|561|2c|"; normalize; classtype: system-event; reference: url,https://www.sonicwall.com/techdocs/pdf/SonicOS-X_7.0.1_LogEvents_ReferenceGuide.pdf; sid:5015159; rev:1;)
#============================================================================
